<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.cauliflower.danielt.smartphoneradar">

    <!--
         The ACCESS_COARSE/FINE_LOCATION permissions are not required to use
         Google Maps Android API v2, but you must specify either coarse or fine
         location permissions for the 'MyLocation' functionality. 
    -->
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.READ_PHONE_STATE" />
    <uses-permission android:name="android.permission.SYSTEM_ALERT_WINDOW" />
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />

    <application
        android:name=".RadarApp"
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher_hat"
        android:label="@string/app_name"
        android:persistent="true"
        android:roundIcon="@mipmap/ic_launcher_hat"
        android:supportsRtl="true"
        android:theme="@style/AppTheme">

        <!--
             The API key for Google Maps-based APIs is defined as a string resource.
             (See the file "res/values/google_maps_api.xml").
             Note that the API key is linked to the encryption key used to sign the APK.
             You need a different API key for each encryption key, including the release key that is used to
             sign the APK for publishing.
             You can define the keys for the debug and release targets in src/debug/ and src/release/.
        -->
        <meta-data
            android:name="com.google.android.geo.API_KEY"
            android:value="@string/google_maps_key" />
        <!--For facebook login-->
        <meta-data
            android:name="com.facebook.sdk.ApplicationId"
            android:value="@string/facebook_application_id" />

        <activity
            android:name="com.facebook.FacebookActivity"
            android:configChanges="keyboard|keyboardHidden|screenLayout|screenSize|orientation"
            android:label="@string/app_name" />
        <activity
            android:name="com.facebook.CustomTabActivity"
            android:exported="true">
            <intent-filter><action android:name="android.intent.action.VIEW" />

                <category android:name="android.intent.category.DEFAULT" />
                <category android:name="android.intent.category.BROWSABLE" />

                <data android:scheme="@string/facebook_login_protocol_scheme" />
            </intent-filter>
        </activity>

        <!--<provider
            android:name=".data.RadarProvider"
            android:authorities="@string/content_authority"
            android:exported="false" />-->

        <activity
            android:name=".ui.SettingsActivity"
            android:launchMode="singleTask">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity
            android:name=".ui.AccountActivity"
            android:label="@string/pref_title_AccountActivity"
            android:parentActivityName=".ui.SettingsActivity">

            <!-- Parent activity meta-data to support 4.0 and lower -->
            <meta-data
                android:name="android.support.PARENT_ACTIVITY"
                android:value=".ui.SettingsActivity" />
        </activity>
        <activity
            android:name=".ui.MapsActivity"
            android:label="@string/pref_title_MapsActivity"
            android:parentActivityName=".ui.SettingsActivity">
            <!-- Parent activity meta-data to support 4.0 and lower -->
            <meta-data
                android:name="android.support.PARENT_ACTIVITY"
                android:value=".ui.SettingsActivity" />
        </activity>

        <service
            android:name=".service.RadarService"
            android:enabled="true"
            android:exported="false" />
        <service
            android:name=".service.NetWatcherJob"
            android:exported="true"
            android:permission="android.permission.BIND_JOB_SERVICE" />

        <!-- ç¶²è·¯çš„é–‹é—œæœƒå•Ÿå‹• NetWatcherï¼Œæœƒé–“æŽ¥å•Ÿå‹•æˆ–é—œé–‰ RadarService -->
        <receiver android:name=".receiver.NetWatcher">
            <intent-filter>
                <action android:name="android.net.conn.CONNECTIVITY_CHANGE" />
            </intent-filter>
        </receiver>

    </application>

</manifest><!--
    todo 00: User storyã€ä½¿ç”¨æµç¨‹ã€å®šä½Serviceé©—è­‰ (done)
    todo 01: Server è³‡æ–™åº«å»ºç«‹ (done) èˆŠç‰ˆåŠŸèƒ½
    todo 02: PHP æŸ¥è©¢ DB (done) èˆŠç‰ˆåŠŸèƒ½
    todo 02: Http æºé€š Server çš„è¨­è¨ˆ (done) èˆŠç‰ˆåŠŸèƒ½
    todo 03: è¨»å†Šå¸³è™Ÿ dialog (done) èˆŠç‰ˆåŠŸèƒ½
    todo 04: å¸³è™Ÿè³‡è¨Š Activity (done)
    todo 05: å®šä½ Service (done)
    todo 06: è¨­å®šé é¢ï¼šæœ‰é—œ sendLocation çš„è¨­å®šï¼Œä½¿ç”¨ PreferenceFragment å¯¦ä½œè©²åŠŸèƒ½
                é–‹å§‹å®šä½é€™æ”¯æ‰‹æ©Ÿ ON/OFFï¼ˆdoneï¼‰
                æ›´æ–°ä½ç½®é–“éš”ï¼ˆæ¯éš”å¹¾ç§’æ›´æ–°ä¸€æ¬¡æ‰‹æ©Ÿçš„ä½ç½®ï¼‰(done)
                ä½¿ç”¨æŒ‡å—
                æŸ¥è©¢å…¶ä»–æ‰‹æ©Ÿä½ç½®ï¼ˆdoneï¼‰
    todo 07: MapsActivity æ‡‰è©²é™„åŠ ä¸€äº›åŠŸèƒ½ï¼ˆç¾ä»Šåº§æ¨™é€éŽ Cluster é¡¯ç¤ºï¼‰
                Cluster åº§æ¨™æ‡‰é™„åŠ  Title(done)
                é¡žä¼¼ Menu buttonï¼Œé»žæ“Šå¾Œ
                    é¡¯ç¤º RecyclerView åˆ—å‡ºæ‰€æœ‰çš„åº§æ¨™ï¼Œè‹¥é»žæ“Šé¸é …å‰‡é¡é ­ç§»å‹•è‡³è©²åº§æ¨™
                    é¡¯ç¤º/éš±è—æ­·å²åº§æ¨™
                    åªé¡¯ç¤ºæ–°åº§æ¨™
                    ç¾åœ¨åœ¨è€ƒæ…®æœ‰ç„¡å¿…è¦è¨­è¨ˆæ–°èˆŠæ¨™è¨˜çš„é¡¯ç¤ºæˆ–éš±è—ï¼Œå› ç‚ºæœ‰æ¸…å–®æä¾›æ‰€æœ‰ç´€éŒ„ï¼Œ
                    æŸ¥è©¢ä»»ä½•æ¨™è¨˜éƒ½å¾ˆæ–¹ä¾¿ï¼Œé™¤éžéŽåŽ»å­˜åœ¨çš„æ¨™è¨˜éŽå¤šï¼Œå¦¨ç¤™æŸ¥çœ‹ï¼Œæ‰€ä»¥ä¿ç•™åŠŸèƒ½ï¼šéš±è—èˆŠçš„åº§æ¨™(done)
                åœ¨æ²’æœ‰ä»»ä½•åº§æ¨™è³‡æ–™æ™‚ï¼Œé ˆåšå‡ºæç¤º()
    todo 08: AccountActivity
                æ˜¯å¦æ‡‰è©²é™åˆ¶ä¸€éš»æ‰‹æ©Ÿåªèƒ½ç¶å®šä¸€å€‹â€œå®šä½â€ç”¨å¸³è™Ÿ?
                æ‡‰è©²æ˜¯çš„ï¼Œä½†è€ƒæ…®åˆ°ä½¿ç”¨è€…ç§»é™¤ï¼¡ï¼°ï¼°æˆ–å…¶è³‡æ–™å¾Œï¼Œå¿˜è¨˜å¸³è™Ÿå¯†ç¢¼
                æ‡‰æ·»åŠ æ–°åŠŸèƒ½ï¼šé©—è­‰ä½¿ç”¨è€…èº«ä»½
                    è¦æ±‚ä½¿ç”¨è€…è¼¸å…¥å¸³è™Ÿèˆ‡ä¿¡ç®±ï¼ŒæŽ¥è‘—å‚³é€ä¸€çµ„é©—è­‰ç¢¼åˆ°ä¿¡ç®±ï¼Œä½¿ç”¨è€…æ–¼ï¼¡ï¼°ï¼°å…§è¼¸å…¥è©²é©—è­‰ç¢¼
                    è‹¥æ­£ç¢ºå‰‡ä½¿ç”¨è©²çµ„é©—è­‰ç¢¼åšç‚ºå¯†ç¢¼(done)

                é€™å€‹æ±ºå®šæ„å‘³è‘—åœ¨ LogInActivity ä¸¦ä¸æœƒæœ‰â€œå®šä½â€å¸³è™Ÿæ¸…å–®èƒ½å¤ é¸æ“‡ä»¥ç™»å…¥
                åªæœ‰â€œæŸ¥è©¢â€å¸³è™Ÿèƒ½å¤ é¸æ“‡(done)
    todo 09: MapsActivity
                ç‚ºåº§æ¨™æ¸…å–®å»ºç«‹æš«å­˜ï¼Œé¿å…å†æ¬¡é€²å…¥ MapsActivity æ™‚é‡æ–°å‘è£ç½®ç«¯ database æŸ¥è©¢åº§æ¨™ (å†è€ƒæ…®)
    todo 10: é‡æ§‹ RadarService, AccountActivity, SettingsFragment(done)

    todo 11: RadarService å¸Œæœ›æ›´æ–°åº§æ¨™æ™‚ å…ˆåˆ¤æ–·èˆ‡ä¸Šä¸€æ¬¡é€å‡ºçš„åº§æ¨™è·é›¢ï¼Œè‹¥è·é›¢åœ¨XXXå…§å‰‡ä¸é€å‡ºé€™æ¬¡çš„åº§æ¨™ï¼Œ
    é€™æ¨£åšçš„å„ªé»žæ˜¯ï¼Œè¿½è¹¤è©²ä½¿ç”¨è€…æ™‚ï¼Œä¸æœƒå› ç‚ºä½¿ç”¨è€…ç§»å‹•è·é›¢ä¸å¤§æˆ–æ²’æœ‰ç§»å‹•ï¼Œå»æŒçºŒç›£è½åˆ°æ›´æ–°çš„åº§æ¨™ï¼Œ
    åœ¨ä¸€å°æ™‚å…§ï¼Œå¯èƒ½åŒä¸€åœ°åœ–å€åŸŸå…§ï¼Œå­˜åœ¨äº† 720 å€‹æ¨™è¨˜ ï¼ˆå‡è¨­ 5 ç§’æ›´æ–°ä¸€æ¬¡åº§æ¨™ï¼‰(done)

    todo 12: æŸ¥é–± firestore ç›£è½æ–‡ä»¶
     metadata.hasPending => true ä»£è¡¨æ˜¯æœªå¯«å…¥ firestore çš„è³‡æ–™
     å…¶å¯¦ä¸æ˜¯ç›£è½å‡ºå•é¡Œï¼Œè€Œæ˜¯locationä¸ŸéŒ¯ä½ç½®äº† RecyclerViewAdapter è·Ÿä»–çš„çˆ¶é¡žåˆ¥éƒ½æœ‰åŒåç¨±çš„ mLocationList
     è€Œæ–°çš„ location add åˆ°äº†çˆ¶é¡žåˆ¥çš„ mLocationListï¼Œç†æ‰€ç•¶ç„¶çš„ï¼ŒRecyclerView æ°¸é æ²’æœ‰æ–°çš„è³‡æ–™ï¼Œ
     å¾Œä¾†æ±ºå®šåªä¿ç•™ä¸€å€‹ locationList å°±å¤ äº†(done)

     todo 13: MapsActivity æ–°å¢žåŠŸèƒ½ï¼Œèƒ½åˆªé™¤æ‰‹æ©Ÿç«¯è³‡æ–™åº«å…§ï¼ŒèˆŠçš„åº§æ¨™
       å¯¦ç¾æ–¹å¼ï¼šå‘å·¦æˆ–å³æ»‘å‹• recyclerView çš„ item å³åˆªé™¤è©²ç­†è³‡æ–™(done)

     todo 14: å› ç‚ºç¾ä»Šä½¿ç”¨ firebase auth èˆ‡ firestore éœ€é‡æ–°æè¿°å„åŠŸèƒ½å¦‚ä½•å¯¦ä½œå®Œæˆï¼Œä»¥åŠå…¶è¦å‰‡

     todo 15: éŽåŽ»å¹¾å€‹æœˆå­¸äº†LiveDataã€ViewModelã€Roomã€DataBindingï¼Œæ˜¯è©²å°‡é€™äº›çŸ¥è­˜åŠ å…¥å°ˆæ¡ˆäº†ï¼Œ
        å¦å‰‡æœ‰ç¨®ç™½å­¸çš„æ„Ÿè¦ºðŸ˜…ã€‚é›–ç„¶å¾—èŠ±ä¸å°‘æˆæœ¬ï¼Œä½†ä¸å˜—è©¦æ€Žæœƒæœ‰æ”¶ç©«å‘¢ðŸ¤¨
        todo 15-1: ç›®å‰æœ€ä¸æ»¿æ„çš„æ˜¯ AccountActivity é€™å€‹ classï¼Œå…ˆè©¦è‘—ä½¿ç”¨ LiveData çš„â€œå¯è§€å¯Ÿâ€ç‰¹æ€§ï¼Œ
        è§€å¯Ÿ FirebaseAuth ä»¥æ¸›å°‘è‡ªè¡Œæª¢æŸ¥ FirebaseAuth ç™»å…¥ç‹€æ³

        todo 15-2: ä½¿ç”¨ DataBinding ä¿®æ”¹ AccountActivity done

        todo 15-3: åœ¨æƒ³å¯ä¸å¯ä»¥å°‡ DataBinding ä½¿ç”¨åœ¨ AccountActivity ä¸­çš„ dialogï¼Œ
        ä½†é€™æ˜¯ä¸æ˜¯ä»£è¡¨è¦åœ¨ AccountActivity çš„ layout æª”ä¸­åŠ å…¥ Dialogï¼Œè€Œä¸” DataBinding çš„ dialog ä¼¼ä¹Žæ²’æœ‰æ›´å¥½ç”¨
        é€™å€‹æƒ³æ³•å…ˆä¿ç•™

        todo 25-4: æ˜¯æ™‚å€™åŠ å…¥ Room äº†ï¼Œé€™å€‹æ±ºå®šæœƒæ›´å‹•åˆ°æ‰€æœ‰èˆ‡è³‡æ–™åº«æœ‰é—œçš„ Class
            æˆ‘æƒ³æ›´æ”¹å€‹åŠŸèƒ½ï¼ŒåŽŸæœ¬åœ¨ AccountActivity å¯ä»¥é¸æ“‡è¦è¿½è¹¤å“ªå€‹å°è±¡ï¼Œ
            æ”¹æˆåœ¨ MapsActivity çš„ menu é¸æ“‡è¿½è¹¤å°è±¡ done

        todo 25-4-1: çªç„¶å†’å‡ºå¾ˆå¤šæƒ³æ³•ï¼Œå¾—æ•´ç†ä¸€ä¸‹...
            1.ä½¿ç”¨è€…çš„å¸³è™Ÿè³‡è¨Šï¼Œä¸å„²å­˜åœ¨æ‰‹æ©Ÿå…§å­˜
                ç›®çš„æœ‰å…©å€‹:  1.å¢žåŠ å€‹è³‡å®‰å…¨
                            2.è³‡æ–™åº«çš„è¨­è¨ˆæ›´å¥½ç†è§£ï¼Œå› ç‚ºéŽåŽ»çš„ user å…¶å¯¦æœ‰å…©ç¨®é¡žåž‹ï¼Œä¸€ç¨®æ˜¯ä½¿ç”¨è€…æœ¬äººï¼Œ
                              ä¸€ç¨®æ˜¯ä½¿ç”¨è€…åœ¨è¿½è¹¤çš„å°è±¡ï¼Œç¾åœ¨æ”¹æˆéƒ½æ˜¯ è¿½è¹¤å°è±¡
                å¦‚ä½•å¯¦ä½œï¼šå…ˆç™»å…¥ firebaseAuthï¼Œå†æ ¹æ“š email å–å¾— firestore è³‡æ–™
                         ï¼ˆå–å¾— firestore è³‡æ–™ä¹‹å¾Œéœ€è¦é©—è­‰ uidã€email èˆ‡ IMEIï¼‰done

                å¾ŒçºŒï¼šUser è³‡æ–™è¡¨å·²ç¶“ä¸éœ€è¦æ¬„ä½ï¼šUSED_FORï¼Œå¯ä»¥ç§»é™¤

            2.ç•¶æœ‰å¤šå€‹è¿½è¹¤å°è±¡æ™‚ï¼Œæ‡‰è©²é¸æ“‡åœ¨ MapsActivity é¡¯ç¤ºå“ªä¸€å€‹è¿½è¹¤å°è±¡ã€‚
                å¦‚ä½•å¯¦ä½œï¼šåœ¨ MapsActivity åŠ æ–°çš„ Menu itemï¼Œé»žæ“Šå¾Œé¡¯ç¤º DialogFragmentï¼Œ
                é¡¯ç¤ºè¿½è¹¤å°è±¡(å–®é¸)ï¼Œå†å°‡é¸å‰‡çµæžœå„²å­˜åˆ° Preference;
                è€Œ MapsActivity é–‹å•Ÿæ™‚éœ€è¦è®€å– Preference ï¼Œå¾—çŸ¥æ‡‰è©²é¡¯ç¤ºå“ªä¸€å€‹è¿½è¹¤å°è±¡çš„ä½ç½® done

            3.æ–°å¢žè¿½è¹¤ç›®æ¨™æ™‚ï¼ŒDialog ä¸­éœ€è¦è¼¸å…¥å°è±¡çš„ Email èˆ‡å¯†ç¢¼ï¼Œè€Œé€™å€‹Dialog èƒ½ä½¿ç”¨ DialogFragment è£½ä½œï¼Œ
                ä¸ç”¨ç¶åœ¨ä»»ä¸€å€‹ Activityï¼Œè¼ƒç‚ºéˆæ´»ã€‚ MapsActivity å³æœ‰æ­¤éœ€æ±‚ï¼Œå› ç‚ºç›®å‰æ˜¯è½‰è·³åˆ° AccountActivity
                æ¯”è¼ƒ low ~

        todo Facebook å®˜æ–¹é€šçŸ¥ï¼Œ ç™»å…¥FBåœ–æ¡ˆä¸ç¬¦åˆæ¨£å¼ï¼Œå¿…é ˆæ”¹æ­£ï¼Œæ–¹æ³•æœ‰å…©å€‹ï¼š
        1. è‡ªè¡Œæ¨¡ä»¿ fb æŒ‰éˆ•æ¨£å¼ï¼Œè¼ƒçœå·¥ï¼Œä½†ä¹Ÿå¯èƒ½è¢«é€€ä»¶
        2. ä½¿ç”¨ Facebook api æä¾›çš„ com.facebook.login.widget.LoginButton å…§å»ºæ¨™æº–æŒ‰éˆ•ï¼Œ
           ä½†éœ€ä½¿ç”¨ Facebook apiï¼Œå› ç‚ºç¾æœ‰ç™»å…¥æ–¹æ³•æ˜¯ Firebase Authentication

        ç•¶ç„¶æ˜¯å‹‡æ•¢çš„é¸æ“‡ Facebook apiï¼
-->
